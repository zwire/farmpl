# 技術スタック

## プログラミング言語 / ライブラリ

- Python 3.13
- uv (パッケージ管理)
- ruff (フォーマット)
- Pydantic (スキーマ記述&型バリデーション)
- OR-Tools + CP-SAT (最適化)

## 技術的アプローチ

- 段階的最適化と部分的重み付けによるハイブリッドアプローチをとる
  - 複数の目的変数の優先順位を陽に定め、解釈性を高めるため
  - 以下 3 つの観点を順に評価することで解が導かれるイメージ
    - 作れるか？(実現可能性)
    - 効率的か？(コスト最適性)
    - リスクは？(品質/安定性)
- 期間は時間窓 (h) で表現する
- 各制約は簡単に ON/OFF でき、単体テストが容易にできるような、疎結合な共通インターフェース設計
  - 各制約は独立して記述することができ、互いに実装が干渉することはない
  - 干渉することがあるのは重み付けが必要な場合のみ
- 解釈性も必要 (実現可能性を満たさない場合に何がネックになっているか)
- 最終的にはガントチャートでプランを提示する
  - 最終的にはWebアプリのフロントエンドを別で作るが、デバッグ用にPython側でも確認機能がほしい

## 変数設計メモ（時間軸 T 拡張）

- 現状の決定変数は日付非依存の `x[l,c]` と採用二値 `z[l,c]`。
- 将来拡張では `x[l,c,t]`（日別面積）とイベント実施二値 `r[e,t]`、労働配分 `h[w,e,t]` を導入。
- スケール: 面積は `AREA_SCALE_UNITS_PER_A=10` を用い 1 unit=0.1a。
- 実装戦略:
  - `Variables` を抽象化（ファクトリで時間軸あり/なしを選択）
  - 制約は `BuildContext` からスケール値と可用な変数を取得し、双方に対応
  - 目的式（利益）は x のスケールに依存するが、比較可能性を保つため同一表現を使う
